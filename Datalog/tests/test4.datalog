.basedir "test_out"

## Domains
T 27 tasks.map
A 10 activations.map
S 10 scopes.map
N 5

.include "../schedule_analysis.core"

#dummies to fill the empty database
subscope0("<dummy>", 0, 0).

#****************************
#test simple "later" param passing
#****************************

#@X: a1:A(a2)->a2:B->a3:C
#and: a4:D->a2 
schedules0("X", "top", "a1", "A").
schedules0("X", "top", "a2", "B").
schedules0("X", "top", "a3", "C").
schedules0("X", "top", "a4", "D").
actual0("X", "a1", 0, "a2").
arrow0("X", "a1", "a2").
arrow0("X", "a2", "a3").
arrow0("X", "a4", "a2").

#@A: a1:E->a2:F-><0>->a3:G
schedules0("A", "top", "a1", "E").
schedules0("A", "top", "a2", "F").
schedules0("A", "top", "a3", "G").
formal0("A", 0, "<0>").
formal0("A", 1, "<1>").
arrow0("A", "a1", "a2").
arrow0("A", "a2", "<0>").
arrow0("A", "<0>", "a3").

#assertions
ERR 256
error4(num:ERR) outputtuples

error4(0) :- !orderedBefore("X", "a1", "a2").
error4(1) :- !orderedBefore("X", "a2", "a3").
error4(2) :- !orderedBefore("X", "a1", "a3").
error4(3) :- !orderedBefore("A", "a1", "a2").
error4(4) :- !orderedBefore("A", "a2", "<0>").
error4(5) :- !orderedBefore("A", "a1", "<0>").
error4(6) :- !orderedBefore("A", "a1", "a3").

error4(7) :- !implies("A", "<0>", "<1>").
error4(7) :- !implies("A", "<1>", "<0>").
error4(8) :- !implies("A", "a1", "<0>").
error4(8) :- !implies("A", "a2", "<0>").
error4(8) :- !implies("A", "a3", "<0>").
error4(9) :- !implies("A", "<0>", "a1").
error4(9) :- !implies("A", "<0>", "a2").
error4(9) :- !implies("A", "<0>", "a3").

error4(10) :- !notExclusive("X", "a1", "a2").
error4(10) :- !notExclusive("X", "a1", "a3").
error4(10) :- !notExclusive("X", "a1", "a4").
error4(10) :- !notExclusive("X", "a4", "a1").
error4(10) :- !notExclusive("A", "a1", "<0>").
error4(10) :- !notExclusive("A", "<0>", "<1>").
error4(10) :- !notExclusive("A", "<0>", "a2").

#simple ordering
error4(11) :- parallel("A", "B").
error4(11) :- parallel("A", "C").
error4(11) :- parallel("A", "G").
error4(11) :- parallel("A", "E").
error4(11) :- parallel("A", "F").
error4(11) :- parallel("E", "F").
error4(11) :- parallel("E", "G").
error4(11) :- !parallel("A", "D").

#ordering through param b
error4(12) :- parallel("E", "B").
error4(13) :- parallel("F", "B").
error4(14) :- parallel("B", "G").
#TODO: transitive param passing is not yet implemented
error4(15) :- parallel("E", "C").
error4(16) :- parallel("F", "C").
error4(17) :- parallel("D", "G").